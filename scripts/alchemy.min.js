"use strict";!function(y,e,v){y.AO=y.AO||{},v(e).on("tinymce-editor-init",function(){AO.tinymce=AO.tinymce||{},AO.tinymce.initialSettings=tinyMCEPreInit.mceInit["alchemy-temp-editor"]}),v(function(){var e=v(".jsAlchemy"),s=v(".jsAlchemyMetaBox"),o=v(".jsAlchemyUserProfile");if(e){var a=v(".jsAlchemyOptions"),t=new URL(y.location.href),n=t.searchParams.get("page")||t.searchParams.get("post"),c=new FormData,l={},i=a.children(".jsAlchemyField"),d=[];if(i.each(function(e,a){var t=v(a);if("sections"===t.data("alchemy").type){var n=t.find(".jsAlchemySectionsTab").children(".jsAlchemyField");n[0]&&n.each(function(e,a){d.push(v(a))})}else d.push(t)}),e.on("click",".jsAlchemySaveOptions",function(){var a=v(this),e=v(d).map(function(e,a){var t=a.data("alchemy");return a.removeClass("alchemy__field--invalid").children(".jsAlchemyValidationTooltip").find(".jsAlchemyTooltipText").text(""),new Function("return AO['get_".concat(t.type,"_value']('").concat(t.id,"');"))(t.id)}).get();v.each(l,function(e,a){a.destroy()}),a.attr("disabled",!0).next(".jsAlchemyLoader").removeClass("alchemy__spinner--hidden");var t=AlchemyData["save-options"];a.data()&&"network"===a.data("type")&&(t=AlchemyData["save-network-options"]),Promise.all(e).then(function(e){c.append("_wpnonce",t.nonce),c.append("page-id",n),c.append("values",JSON.stringify(e)),v.ajax({method:"POST",url:t.url,dataType:"json",processData:!1,contentType:!1,data:c,success:function(){y.location.reload()},error:function(e){if(e.responseJSON.data&&"alch-save-validation-errors"===e.responseJSON.code){var s=e.responseJSON.data["invalid-fields"],o=0;v(d).each(function(e,a){var t=a.data("alchemy");if(s[t.id]){var n=a.children(".jsAlchemyValidationTooltip"),i=a.offset().top;o=-100+(o<i?i:o),n[0]&&(n.attr("data-show",!0).find(".jsAlchemyTooltipText").text(s[t.id]),a.addClass("alchemy__field--invalid").parents(".repeatee").addClass("repeatee--expanded"),l[t.id]=Popper.createPopper(a[0],n[0],{placement:"top",modifiers:[{name:"flip",options:{fallbackPlacements:["top-start"]}}]}),a.one("hover focus",function(){a.hasClass("alchemy__field--invalid")&&(a.removeClass("alchemy__field--invalid"),l[t.id]&&(l[t.id].destroy(),n.removeAttr("data-show")))}),o&&v("html").add("body").animate({scrollTop:o},500))}})}a.next(".jsAlchemyLoader").addClass("alchemy__spinner--hidden")},complete:function(){a.removeAttr("disabled")}})})}),s[0]){var r=v("#post"),p=s.closest(".postbox");if(p.find(".hndle").removeClass("hndle"),p.find(".handle-order-higher").remove(),p.find(".handle-order-lower").remove(),r[0])v("#publish, #save-post").one("click",function(e){e.preventDefault();var a=v(this);a.attr("disabled",!0),f(a)});else if(wp.data&&wp.data.subscribe){var h=!0;wp.data.subscribe(function(){wp.data.select("core/editor").isSavingPost()?h=!1:h||(f(),h=!0)})}}if(o[0]){var m=v("#your-profile"),u=!1;m[0]&&m.on("submit",function(e){if(u)m.find('[type="submit"]').removeAttr("disabled").addClass("disabled").click();else{var a=o.children(".jsAlchemyField"),i=[];m.find('[type="submit"]').attr("disabled",!0),a.each(function(e,a){var t=v(a);if("sections"===t.data("alchemy").type){var n=t.find(".jsAlchemySectionsTab").children(".jsAlchemyField");n[0]&&n.each(function(e,a){i.push(v(a))})}else i.push(t)});var t=v(i).map(function(e,a){var t=v(a).data("alchemy");return new Function("return AO['get_".concat(t.type,"_value']('").concat(t.id,"');"))(t.id)}).get(),n=AlchemyData["save-user-profile"];Promise.all(t).then(function(e){c.append("_wpnonce",n.nonce),c.append("user-id",n.userID),c.append("values",JSON.stringify(e)),v.ajax({method:"POST",url:n.url,dataType:"json",processData:!1,contentType:!1,data:c,success:function(){m.submit()}})}),e.preventDefault()}u=!0})}}function f(a){var e=s.children(".metabox__fields").children(".jsAlchemyField"),i=[];e.each(function(e,a){var t=v(a);if("sections"===t.data("alchemy").type){var n=t.find(".jsAlchemySectionsTab").children(".jsAlchemyField");n[0]&&n.each(function(e,a){i.push(v(a))})}else i.push(t)});var t=v(i).map(function(e,a){var t=v(a).data("alchemy");return new Function("return AO['get_".concat(t.type,"_value']('").concat(t.id,"');"))(t.id)}).get(),n=AlchemyData["save-metaboxes"];Promise.all(t).then(function(e){c.append("_wpnonce",n.nonce),c.append("post-id",n.postID),c.append("values",JSON.stringify(e)),v.ajax({method:"POST",url:n.url,dataType:"json",processData:!1,contentType:!1,data:c,success:function(){a&&a[0]&&a.removeAttr("disabled").click()}})})}})}(window,document,jQuery);
//# sourceMappingURL=alchemy.min.js.map