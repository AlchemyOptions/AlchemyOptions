{"version":3,"sources":["fields/taxonomy-select/scripts.js"],"names":["window","document","$","AO","$document","ptsData","AlchemyTaxonomySelectData","currentUrl","URL","fieldData","searchParams","select2","locale","location","href","pageID","get","type","dataType","delay","url","params","data","searchedFor","term","_wpnonce","nonce","taxonomy","page-id","processResults","results","$target","minimumInputLength","append","change","e","target","siblings","children","concat","on","id","option","detach","$select","Promise","resolve","val","ready","$ptsSelects","initialise_taxonomy_select","each","i","select","repeatee","get_taxonomy_select_value","jQuery","value"],"mappings":"AAAA,cAEA,SAACA,EAAAC,EAAAC,GACGF,EAAAG,GAAYH,EAAAG,IAAZ,GAIAC,IAAAA,EAAgBF,EAAAD,GAwBZ,SAAMI,EAAUC,GACVC,IAAAA,EAAaL,EAAIM,GACXC,EAAGF,EAAWG,KAAAA,WAElBC,EAAQL,0BAAA,OACJC,EAAYK,IAAAA,IADRZ,EAAAa,SAAAC,MAENC,EAAAR,EAAAG,aAAAM,IAAA,SAAAT,EAAAG,aAAAM,IAAA,QAEFC,EAAMN,QAFJ,CAGFO,SAAUT,EAHRG,OAIFO,KAJE,CAKIC,IAAAf,EAAAgB,IACFJ,KAAO,MACHC,SAAA,OACAC,MAAA,IACAG,KAAA,SAAAD,GACA,MAAWN,CAJfQ,YAAAF,EAAAG,KANFC,SAAApB,EAAAqB,MAacC,SAAAlB,EAAA,SACLmB,UAAAb,IAdTc,eAAA,SAAAP,GAkBK,MAAA,CApBCQ,QAAAR,EAAAA,OAwBNS,OAAa,GAGbC,mBAAN,IACAD,GAAQE,iBAAeC,SAAAA,GA5B3B,IAAAH,EAAA7B,EAAAiC,EAAAC,QA+BQC,EAASN,EAAAO,SAAA,UAAAC,OAAiCC,EAAlDnB,OAAqDC,KAASmB,GAA7C,MAAjBC,EAAAC,SAGHZ,EAAAE,OAAAS,GAAAR,WAGGU,EAAOC,SAAQC,iCAASN,GAAA,QAAA,WACpBI,EAAQG,IAAA,IAAAb,WAlEhB9B,EAAU4C,MAAM,WAGRC,IAAAA,EAAiB/C,EAAA,4BAEbgD,EAAAA,IADJD,EAAAE,KAAA,SAAAC,EAAAC,GAGHH,EAAAG,OAGLjD,EAAUoC,GAAG,sBAAuB,SAASL,EAAGb,GAIxC2B,IACAA,EADiB3B,EAAAgC,SACID,KAAJ,4BAAjBJ,EAAA,IAGHA,EAAAE,KAAA,SAAAC,EAAAC,GARLH,EAAAG,OAsDAlD,GAAAoD,0BAAA,SAAAd,GAODzC,OAAQC,QAAUuD,QA5ErB,CAuEYvC,KAAQ,kBACRwB,GAAMA,EACNgB,MAASvD,EAAC,IAAAqC,OAAKE,IAAMM,SAzEjC,CA4EG/C,OAAQC,SAAUuD","file":"fields\\taxonomy-select\\scripts.min.js","sourcesContent":["\"use strict\";\n\n(function(window, document, $) {\n    window.AO = window.AO || {};\n\n    const $document = $(document);\n\n    $document.ready(() => {\n        const $ptsSelects = $('.jsAlchemyTaxonomySelect');\n\n        if( $ptsSelects[0] ) {\n            $ptsSelects.each((i, select) => {\n                initialise_taxonomy_select(select);\n            });\n        }\n    });\n\n    $document.on('alch_repeatee_added', function(e, data) {\n        const $repeatee = data.repeatee;\n        const $ptsSelects = $repeatee.find('.jsAlchemyTaxonomySelect');\n\n        if( $ptsSelects[0] ) {\n            $ptsSelects.each((i, select) => {\n                initialise_taxonomy_select(select);\n            });\n        }\n    });\n\n    function initialise_taxonomy_select(taxonomySelect) {\n        const $select = $(taxonomySelect);\n        const fieldData = $select.data('alchemy');\n        const ptsData = AlchemyTaxonomySelectData['search'];\n        const currentUrl = new URL(window.location.href);\n        const pageID = currentUrl.searchParams.get('page') || currentUrl.searchParams.get('post');\n\n        $select.select2({\n            language: fieldData.locale,\n            ajax: {\n                url: ptsData.url,\n                type: 'get',\n                dataType: 'json',\n                delay: 250,\n                data: params => {\n                    return {\n                        'searchedFor': params.term,\n                        '_wpnonce': ptsData.nonce,\n                        'taxonomy': fieldData['taxonomy'],\n                        'page-id': pageID\n                    };\n                },\n                processResults: data => {\n                    return {\n                        results: data.data,\n                    };\n                },\n                cache: false\n            },\n            minimumInputLength: 2\n        }).on('select2:select', e => {\n            const $target = $(e.target);\n            const option = $target.children(`[value=${e.params.data.id}]`);\n\n            option.detach();\n            $target.append(option).change();\n        });\n\n        $select.siblings('.jsAlchemyTaxonomySelectClear').on('click', () => {\n            $select.val(\"\").change();\n        });\n    }\n\n    AO.get_taxonomy_select_value = id => {\n        return Promise.resolve( {\n            'type': 'taxonomy_select',\n            'id': id,\n            'value': $(`#${id}`).val()\n        } );\n    };\n})(window, document, jQuery);\n"]}